<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Plot Overrepresented Kmers — plotKmers • ngsReports</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/simplex/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Plot Overrepresented Kmers — plotKmers"><meta property="og:description" content="Plot Overrepresented Kmers"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ngsReports</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.5.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/ngsReportsIntroduction.html">An Introduction to ngsReports</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/smped/ngsReports" class="external-link">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Plot Overrepresented Kmers</h1>
    <small class="dont-index">Source: <a href="https://github.com/smped/ngsReports/blob/HEAD/R/plotKmers.R" class="external-link"><code>R/plotKmers.R</code></a></small>
    <div class="hidden name"><code>plotKmers-methods.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Plot Overrepresented Kmers</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plotKmers</span><span class="op">(</span><span class="va">x</span>, usePlotly <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">labels</span>, pattern <span class="op">=</span> <span class="st">".(fast|fq|bam).*"</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for ANY</span></span>
<span><span class="fu">plotKmers</span><span class="op">(</span><span class="va">x</span>, usePlotly <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">labels</span>, pattern <span class="op">=</span> <span class="st">".(fast|fq|bam).*"</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for FastqcData</span></span>
<span><span class="fu">plotKmers</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  usePlotly <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">labels</span>,</span>
<span>  pattern <span class="op">=</span> <span class="st">".(fast|fq|bam).*"</span>,</span>
<span>  n <span class="op">=</span> <span class="fl">6</span>,</span>
<span>  linewidth <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  plotlyLegend <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  scaleColour <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  pal <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"blue"</span>, <span class="st">"green"</span>, <span class="st">"black"</span>, <span class="st">"magenta"</span>, <span class="st">"yellow"</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for FastqcDataList</span></span>
<span><span class="fu">plotKmers</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  usePlotly <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">labels</span>,</span>
<span>  pattern <span class="op">=</span> <span class="st">".(fast|fq|bam).*"</span>,</span>
<span>  cluster <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  dendrogram <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">pwfCols</span>,</span>
<span>  showPwf <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  scaleFill <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  heatCol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">hcl.colors</a></span><span class="op">(</span><span class="fl">50</span>, <span class="st">"inferno"</span><span class="op">)</span>,</span>
<span>  heat_w <span class="op">=</span> <span class="fl">8</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for FastpData</span></span>
<span><span class="fu">plotKmers</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  usePlotly <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">labels</span>,</span>
<span>  pattern <span class="op">=</span> <span class="st">".(fast|fq|bam).*"</span>,</span>
<span>  module <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Before_filtering"</span>, <span class="st">"After_filtering"</span><span class="op">)</span>,</span>
<span>  reads <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"read1"</span>, <span class="st">"read2"</span><span class="op">)</span>,</span>
<span>  readsBy <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"facet"</span>, <span class="st">"mean"</span>, <span class="st">"diff"</span><span class="op">)</span>,</span>
<span>  trans <span class="op">=</span> <span class="st">"log2"</span>,</span>
<span>  scaleFill <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  plotTheme <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  plotlyLegend <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x</dt>
<dd><p>Can be a <code>FastqcData</code>, <code>FastqcDataList</code> or file paths</p></dd>


<dt>usePlotly</dt>
<dd><p><code>logical</code> Default <code>FALSE</code> will render using
ggplot. If <code>TRUE</code> plot will be rendered with plotly</p></dd>


<dt>labels</dt>
<dd><p>An optional named vector of labels for the file names.
All filenames must be present in the names.</p></dd>


<dt>pattern</dt>
<dd><p>regex to drop from the end of filenames</p></dd>


<dt>...</dt>
<dd><p>Used to pass parameters to theme for FastqcData objects and to
geoms for FastpData objects</p></dd>


<dt>n</dt>
<dd><p><code>numeric</code>. The number of Kmers to show.</p></dd>


<dt>linewidth</dt>
<dd><p>Passed to <code><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line()</a></code></p></dd>


<dt>plotlyLegend</dt>
<dd><p>Show legend for interactive plots</p></dd>


<dt>pal</dt>
<dd><p>The colour palette. If the vector supplied is less than n,
<code><a href="https://rdrr.io/r/grDevices/colorRamp.html" class="external-link">grDevices::colorRampPalette()</a></code> will be used</p></dd>


<dt>cluster</dt>
<dd><p><code>logical</code> default <code>FALSE</code>. If set to <code>TRUE</code>,
fastqc data will be clustered using hierarchical clustering</p></dd>


<dt>dendrogram</dt>
<dd><p><code>logical</code> redundant if <code>cluster</code> is <code>FALSE</code>
if both <code>cluster</code> and <code>dendrogram</code> are specified as <code>TRUE</code>
then the dendrogram will be displayed.</p></dd>


<dt>pwfCols</dt>
<dd><p>Object of class <code><a href="PwfCols-class.html">PwfCols()</a></code> to give colours for
pass, warning, and fail values in the plot</p></dd>


<dt>showPwf</dt>
<dd><p>Show the PASS/WARN/FAIL status</p></dd>


<dt>scaleFill, scaleColour</dt>
<dd><p>ggplot2 scales to be used for colour palettes</p></dd>


<dt>heatCol</dt>
<dd><p>Colour palette used for the heatmap. Default is <code>inferno</code>
from the viridis set of palettes</p></dd>


<dt>heat_w</dt>
<dd><p>Relative width of any heatmap plot components</p></dd>


<dt>module</dt>
<dd><p>The module to obtain data from when using a FastpData object</p></dd>


<dt>reads</dt>
<dd><p>Either read1 or read2. Only used when using a FastpData object</p></dd>


<dt>readsBy</dt>
<dd><p>Strategy for visualising both read1 and read2. Can be set to
show each set of reads by facet, or within the same plot taking the mean of
the enrichment above mean, or the difference in the enrichment above mean</p></dd>


<dt>trans</dt>
<dd><p>Function for transforming the count/mean ratio. Set as NULL
to use the ratio without transformation</p></dd>


<dt>plotTheme</dt>
<dd><p><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a> object</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A standard ggplot2 object or an interactive plotly object</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>As the Kmer Content module present in FastQC reports is relatively
uninformative, and omitted by default in later versions of FastQC, these
are rudimentary plots.</p>
<p>Plots for <code>FastqcData</code> objects replicate those contained in a FastQC
report, whilst the heatmap generated from <code>FastqcDataList</code> objects
simply show the location and abundance of over-represented Kmers.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Get the files included with the package</span></span></span>
<span class="r-in"><span><span class="va">packageDir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package <span class="op">=</span> <span class="st">"ngsReports"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="va">packageDir</span>, pattern <span class="op">=</span> <span class="st">"fastqc.zip"</span>, full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Load the FASTQC data as a FastqcDataList object</span></span></span>
<span class="r-in"><span><span class="va">fdl</span> <span class="op">&lt;-</span> <span class="fu"><a href="FastqcDataList.html">FastqcDataList</a></span><span class="op">(</span><span class="va">fl</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">plotKmers</span><span class="op">(</span><span class="va">fdl</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plotKmers-methods-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Use a FastpData object</span></span></span>
<span class="r-in"><span><span class="va">fl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"fastp.json.gz"</span>, package <span class="op">=</span> <span class="st">"ngsReports"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fp</span> <span class="op">&lt;-</span> <span class="fu"><a href="FastpData.html">FastpData</a></span><span class="op">(</span><span class="va">fl</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">plotKmers</span><span class="op">(</span><span class="va">fp</span>, size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plotKmers-methods-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">plotKmers</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">fp</span>, reads <span class="op">=</span> <span class="st">"read1"</span>, size <span class="op">=</span> <span class="fl">2</span>, trans <span class="op">=</span> <span class="cn">NULL</span>,</span></span>
<span class="r-in"><span>  scaleFill <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_fill_gradient</a></span><span class="op">(</span>low <span class="op">=</span> <span class="st">"white"</span>, high <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plotKmers-methods-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Stevie Pederson, <a href="https://github.com/CMWbio" class="external-link">Christopher Ward</a>, <a href="https://github.com/tothuhien" class="external-link">Thu-Hien To</a>.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

