<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Draw an Adapter Content Plot — plotAdapterContent • ngsReports</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/simplex/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Draw an Adapter Content Plot — plotAdapterContent"><meta property="og:description" content="Draw an Adapter Content Plot across one or more FASTQC reports"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ngsReports</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.5.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/ngsReportsIntroduction.html">An Introduction to ngsReports</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/smped/ngsReports" class="external-link">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Draw an Adapter Content Plot</h1>
    <small class="dont-index">Source: <a href="https://github.com/smped/ngsReports/blob/HEAD/R/plotAdapterContent.R" class="external-link"><code>R/plotAdapterContent.R</code></a></small>
    <div class="hidden name"><code>plotAdapterContent-methods.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Draw an Adapter Content Plot across one or more FASTQC reports</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plotAdapterContent</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  usePlotly <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">labels</span>,</span>
<span>  pattern <span class="op">=</span> <span class="st">".(fast|fq|bam).*"</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for ANY</span></span>
<span><span class="fu">plotAdapterContent</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  usePlotly <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">labels</span>,</span>
<span>  pattern <span class="op">=</span> <span class="st">".(fast|fq|bam).*"</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for FastqcData</span></span>
<span><span class="fu">plotAdapterContent</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  usePlotly <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">labels</span>,</span>
<span>  pattern <span class="op">=</span> <span class="st">".(fast|fq|bam).*"</span>,</span>
<span>  <span class="va">pwfCols</span>,</span>
<span>  showPwf <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  warn <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  fail <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  scaleColour <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  plotlyLegend <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for FastqcDataList</span></span>
<span><span class="fu">plotAdapterContent</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  usePlotly <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">labels</span>,</span>
<span>  pattern <span class="op">=</span> <span class="st">".(fast|fq|bam).*"</span>,</span>
<span>  <span class="va">pwfCols</span>,</span>
<span>  showPwf <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  warn <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  fail <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  plotType <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"heatmap"</span>, <span class="st">"line"</span><span class="op">)</span>,</span>
<span>  adapterType <span class="op">=</span> <span class="st">"Total"</span>,</span>
<span>  cluster <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  dendrogram <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  heat_w <span class="op">=</span> <span class="fl">8L</span>,</span>
<span>  scaleFill <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  scaleColour <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  plotlyLegend <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for FastpData</span></span>
<span><span class="fu">plotAdapterContent</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  usePlotly <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">labels</span>,</span>
<span>  pattern <span class="op">=</span> <span class="st">".(fast|fq|bam).*"</span>,</span>
<span>  scaleFill <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  plotlyLegend <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  plotTheme <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme_get.html" class="external-link">theme_get</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for FastpDataList</span></span>
<span><span class="fu">plotAdapterContent</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  usePlotly <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">labels</span>,</span>
<span>  pattern <span class="op">=</span> <span class="st">".(fast|fq|bam).*"</span>,</span>
<span>  <span class="va">pwfCols</span>,</span>
<span>  showPwf <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  warn <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  fail <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  cluster <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  dendrogram <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  scaleFill <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  plotTheme <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme_get.html" class="external-link">theme_get</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  heat_w <span class="op">=</span> <span class="fl">8L</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x</dt>
<dd><p>Can be a <code>FastqcData</code>, a <code>FastqcDataList</code> or character
vector of file paths</p></dd>


<dt>usePlotly</dt>
<dd><p><code>logical</code>. Output as ggplot2 (default) or plotly
object.</p></dd>


<dt>labels</dt>
<dd><p>An optional named vector of labels for the file names.
All filenames must be present in the names.</p></dd>


<dt>pattern</dt>
<dd><p>regex used to trim the ends of all filenames for plotting</p></dd>


<dt>...</dt>
<dd><p>Used to pass additional attributes to theme() for FastQC objects
and geoms for Fastp objects</p></dd>


<dt>pwfCols</dt>
<dd><p>Object of class <code><a href="PwfCols-class.html">PwfCols()</a></code> containing the colours
for PASS/WARN/FAIL</p></dd>


<dt>showPwf</dt>
<dd><p>logical(1) Show PASS/WARN/FAIL status as would be included in
a standard FastQC report</p></dd>


<dt>warn, fail</dt>
<dd><p>The default values for warn and fail are 5 and 10
respectively (i.e. percentages)</p></dd>


<dt>plotlyLegend</dt>
<dd><p>logical(1) Show legend when choosing interactive plots.
Ignored for heatmaps</p></dd>


<dt>plotType</dt>
<dd><p><code>character</code>. Can only take the values
<code>plotType = "heatmap"</code> or <code>plotType = "line"</code></p></dd>


<dt>adapterType</dt>
<dd><p>A regular expression matching the adapter(s) to be
plotted. To plot all adapters summed, specify <code>adapterType = "Total"</code>.
This is the default behaviour.</p></dd>


<dt>cluster</dt>
<dd><p><code>logical</code> default <code>FALSE</code>. If set to <code>TRUE</code>,
fastqc data will be clustered using hierarchical clustering</p></dd>


<dt>dendrogram</dt>
<dd><p><code>logical</code> redundant if <code>cluster</code> is <code>FALSE</code>
if both <code>cluster</code> and <code>dendrogram</code> are specified as <code>TRUE</code>
then the dendrogram will be displayed.</p></dd>


<dt>heat_w</dt>
<dd><p>Width of the heatmap relative to other plot components</p></dd>


<dt>scaleFill, scaleColour</dt>
<dd><p>scale_fill\* and scale_colour_\* objects</p></dd>


<dt>plotTheme</dt>
<dd><p>Set theme elements by passing a <a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A standard ggplot2 object, or an interactive plotly object</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>This extracts the Adapter_Content module from the supplied object and
generates a ggplot2 object, with a set of minimal defaults.
The output of this function can be further modified using the standard
ggplot2 methods.</p>
<p>When <code>x</code> is a single or FastqcData object line plots will always be
drawn for all adapters.
Otherwise, users can select line plots or heatmaps.
When plotting more than one fastqc file, any undetected adapters will not be
shown.</p>
<p>An interactive version of the plot can be made by setting <code>usePlotly</code>
as <code>TRUE</code></p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Get the files included with the package</span></span></span>
<span class="r-in"><span><span class="va">packageDir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package <span class="op">=</span> <span class="st">"ngsReports"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="va">packageDir</span>, pattern <span class="op">=</span> <span class="st">"fastqc.zip"</span>, full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Load the FASTQC data as a FastqcDataList object</span></span></span>
<span class="r-in"><span><span class="va">fdl</span> <span class="op">&lt;-</span> <span class="fu"><a href="FastqcDataList.html">FastqcDataList</a></span><span class="op">(</span><span class="va">fl</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># The default plot</span></span></span>
<span class="r-in"><span><span class="fu">plotAdapterContent</span><span class="op">(</span><span class="va">fdl</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plotAdapterContent-methods-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Also subset the reads to just the R1 files</span></span></span>
<span class="r-in"><span><span class="va">r1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"R1"</span>, <span class="fu"><a href="fqName-methods.html">fqName</a></span><span class="op">(</span><span class="va">fdl</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">plotAdapterContent</span><span class="op">(</span><span class="va">fdl</span><span class="op">[</span><span class="va">r1</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plotAdapterContent-methods-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot just the Universal Adapter</span></span></span>
<span class="r-in"><span><span class="co"># and change the y-axis using ggplot2::scale_y_continuous</span></span></span>
<span class="r-in"><span><span class="fu">plotAdapterContent</span><span class="op">(</span><span class="va">fdl</span>, adapterType <span class="op">=</span><span class="st">"Illumina_Universal"</span>, plotType <span class="op">=</span> <span class="st">"line"</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">Filename</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plotAdapterContent-methods-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># For FastpData object, the plots are slightly different</span></span></span>
<span class="r-in"><span><span class="va">fp</span> <span class="op">&lt;-</span> <span class="fu"><a href="FastpData.html">FastpData</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/fastp.json.gz"</span>, package <span class="op">=</span> <span class="st">"ngsReports"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">plotAdapterContent</span><span class="op">(</span><span class="va">fp</span>, scaleFill <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_fill_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Set1"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plotAdapterContent-methods-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Stevie Pederson, <a href="https://github.com/CMWbio" class="external-link">Christopher Ward</a>, <a href="https://github.com/tothuhien" class="external-link">Thu-Hien To</a>.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

